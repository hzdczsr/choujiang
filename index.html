<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¾°å…‰æœªæ¥æ˜Ÿ - æ™ºèƒ½å­¦ä¹ ç³»ç»Ÿ</title>
  <style>
    /* å…¨å±€æ ·å¼ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Inter, system-ui, Avenir, Helvetica, Arial, sans-serif;
      line-height: 1.5;
      color: #e6e6e6;
      background-color: #1e1e1e;
      background-image: linear-gradient(to bottom right, #1e1e1e, #252526);
    }

    #root {
      width: 100%;
      min-height: 100vh;
    }

    /* Windows 11 é£æ ¼å˜é‡ */
    :root {
      --primary-color: #0078d4;
      --secondary-color: #005a9e;
      --accent-color: #00b7c3;
      --background-color: #1e1e1e;
      --surface-color: #2d2d30;
      --surface-hover-color: #3a3a3d;
      --text-color: #e6e6e6;
      --text-secondary-color: #969696;
      --border-color: #424242;
      --border-radius: 8px;
      --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.3);
      --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.4);
      --shadow-lg: 0 8px 16px rgba(0, 0, 0, 0.5);
      --transition: all 0.2s ease-in-out;
    }

    /* å¯¼èˆªæ  */
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 2rem;
      background-color: var(--surface-color);
      background-image: linear-gradient(to bottom, #2d2d30, #252526);
      border-bottom: 1px solid var(--border-color);
      box-shadow: var(--shadow-md);
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(8px);
    }

    .navbar-logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--text-color);
      text-decoration: none;
      transition: transform 0.2s ease-in-out;
    }

    .navbar-logo:hover {
      transform: scale(1.02);
    }

    .logo-icon {
      width: 40px;
      height: 40px;
      border-radius: var(--border-radius);
      background-color: var(--primary-color);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
    }

    .logo-image {
      width: 60px;
      height: 60px;
      border-radius: var(--border-radius);
      object-fit: contain;
      transition: transform 0.2s ease-in-out;
    }

    .logo-image:hover {
      transform: scale(1.05);
    }

    .navbar-nav {
      display: flex;
      gap: 2rem;
      list-style: none;
    }

    .navbar-nav button {
      background: none;
      border: none;
      color: var(--text-secondary-color);
      font-weight: 500;
      font-size: 1rem;
      cursor: pointer;
      padding: 0.5rem 0;
      position: relative;
      transition: var(--transition);
    }

    .navbar-nav button:hover {
      color: var(--primary-color);
    }

    .navbar-nav button::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background-color: var(--primary-color);
      transition: width 0.2s ease-in-out;
    }

    .navbar-nav button:hover::after {
      width: 100%;
    }

    .navbar-nav button.nav-active {
      color: var(--primary-color);
    }

    .navbar-nav button.nav-active::after {
      width: 100%;
    }

    .navbar-btn {
      padding: 0.6rem 1.5rem;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow-sm);
    }

    .navbar-btn:hover {
      background-color: var(--secondary-color);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    /* è‹±é›„åŒºåŸŸ */
    .hero {
      padding: 5rem 2rem;
      text-align: center;
      background-color: var(--background-color);
      background-image: linear-gradient(to bottom right, #1e1e1e, #252526),
                        radial-gradient(circle at 20% 50%, rgba(0, 120, 212, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(0, 183, 195, 0.1) 0%, transparent 50%);
      background-blend-mode: overlay;
      position: relative;
      overflow: hidden;
      border-bottom: 1px solid var(--border-color);
    }

    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: radial-gradient(circle at 20% 50%, rgba(0, 120, 212, 0.05) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(0, 183, 195, 0.05) 0%, transparent 50%);
      pointer-events: none;
    }

    .hero h1 {
      font-size: 3.5rem;
      font-weight: bold;
      margin-bottom: 1rem;
      color: var(--text-color);
      position: relative;
      z-index: 1;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    .hero p {
      font-size: 1.3rem;
      color: var(--text-secondary-color);
      margin-bottom: 2.5rem;
      position: relative;
      z-index: 1;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    .hero-buttons {
      display: flex;
      gap: 1.5rem;
      justify-content: center;
      position: relative;
      z-index: 1;
      flex-wrap: wrap;
    }

    .btn {
      padding: 0.875rem 2.25rem;
      border: none;
      border-radius: var(--border-radius);
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
      display: inline-block;
      font-size: 1.05rem;
      box-shadow: var(--shadow-md);
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--secondary-color);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .btn-secondary {
      background-color: var(--surface-color);
      color: var(--primary-color);
      border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
      background-color: var(--surface-hover-color);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* åŠŸèƒ½åŒºåŸŸ */
    .features {
      padding: 5rem 2rem;
      max-width: 1200px;
      margin: 0 auto;
      background-color: var(--background-color);
    }

    .features h2 {
      font-size: 2.8rem;
      font-weight: bold;
      text-align: center;
      margin-bottom: 3.5rem;
      color: var(--text-color);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 2.5rem;
    }

    .feature-card {
      background-color: var(--surface-color);
      background-image: linear-gradient(to bottom, #2d2d30, #252526);
      border-radius: var(--border-radius);
      padding: 2.5rem;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-md);
      transition: var(--transition);
      text-align: left;
      position: relative;
      overflow: hidden;
    }

    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background-color: var(--primary-color);
      transform: scaleX(0);
      transition: transform 0.3s ease-in-out;
    }

    .feature-card:hover {
      transform: translateY(-8px);
      box-shadow: var(--shadow-lg);
      border-color: var(--primary-color);
    }

    .feature-card:hover::before {
      transform: scaleX(1);
    }

    .feature-icon {
      width: 70px;
      height: 70px;
      border-radius: var(--border-radius);
      background-color: rgba(0, 120, 212, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1.75rem;
      font-size: 1.8rem;
      color: var(--primary-color);
      transition: var(--transition);
    }

    .feature-card:hover .feature-icon {
      background-color: rgba(0, 120, 212, 0.2);
      transform: scale(1.05);
    }

    .feature-card h3 {
      font-size: 1.4rem;
      font-weight: bold;
      margin-bottom: 1.25rem;
      color: var(--text-color);
    }

    .feature-card p {
      color: var(--text-secondary-color);
      margin-bottom: 1.75rem;
      line-height: 1.6;
    }

    .feature-btn {
      padding: 0.6rem 1.2rem;
      background-color: rgba(0, 120, 212, 0.1);
      color: var(--primary-color);
      border: 1px solid var(--primary-color);
      border-radius: var(--border-radius);
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .feature-btn:hover {
      background-color: var(--primary-color);
      color: white;
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
    }

    /* åŠŸèƒ½é¡µé¢ */
    .features-page {
      padding: 4rem 2rem;
      min-height: 100vh;
      background-color: var(--background-color);
      background-image: linear-gradient(to bottom right, #1e1e1e, #252526);
    }

    .features-page-header {
      text-align: center;
      margin-bottom: 4rem;
      padding-bottom: 2rem;
      border-bottom: 1px solid var(--border-color);
    }

    .features-page-header h1 {
      font-size: 3rem;
      font-weight: bold;
      margin-bottom: 1rem;
      color: var(--text-color);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    .features-page-header p {
      font-size: 1.2rem;
      color: var(--text-secondary-color);
      max-width: 800px;
      margin: 0 auto;
    }

    .features-category {
      margin-bottom: 4rem;
    }

    .features-category h2 {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 2rem;
      color: var(--text-color);
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .features-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
    }

    .feature-item {
      background-color: var(--surface-color);
      border-radius: var(--border-radius);
      padding: 2rem;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-md);
      transition: var(--transition);
      text-align: center;
    }

    .feature-item:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
      border-color: var(--primary-color);
    }

    .feature-item-icon {
      font-size: 3rem;
      margin-bottom: 1.5rem;
      transition: var(--transition);
    }

    .feature-item:hover .feature-item-icon {
      transform: scale(1.1);
    }

    .feature-item h3 {
      font-size: 1.3rem;
      font-weight: bold;
      margin-bottom: 1rem;
      color: var(--text-color);
    }

    .feature-item p {
      color: var(--text-secondary-color);
      margin-bottom: 1.5rem;
      line-height: 1.6;
    }

    .feature-item-btn {
      padding: 0.6rem 1.5rem;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow-sm);
    }

    .feature-item-btn:hover {
      background-color: var(--secondary-color);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    /* AIå¯¹è¯åŒºåŸŸ */
    .ai-chat {
      padding: 5rem 2rem;
      background-color: var(--background-color);
      background-image: linear-gradient(to bottom right, #1e1e1e, #252526);
      border-top: 1px solid var(--border-color);
    }

    .ai-chat-container {
      max-width: 850px;
      margin: 0 auto;
      background-color: var(--surface-color);
      background-image: linear-gradient(to bottom, #2d2d30, #252526);
      border-radius: var(--border-radius);
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-lg);
      overflow: hidden;
    }

    .ai-chat-header {
      padding: 1.5rem;
      background-color: var(--primary-color);
      background-image: linear-gradient(to right, #0078d4, #005a9e);
      color: white;
      font-weight: bold;
      font-size: 1.25rem;
      border-bottom: 1px solid var(--border-color);
    }

    .ai-chat-messages {
      padding: 1.75rem;
      height: 450px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
      background-color: rgba(0, 0, 0, 0.1);
    }

    /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
    .ai-chat-messages::-webkit-scrollbar {
      width: 6px;
    }

    .ai-chat-messages::-webkit-scrollbar-track {
      background: var(--surface-color);
      border-radius: 3px;
    }

    .ai-chat-messages::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 3px;
    }

    .ai-chat-messages::-webkit-scrollbar-thumb:hover {
      background: var(--primary-color);
    }

    .message {
      max-width: 80%;
      padding: 1.25rem;
      border-radius: var(--border-radius);
      line-height: 1.5;
      box-shadow: var(--shadow-sm);
    }

    .message.user {
      align-self: flex-end;
      background-color: rgba(0, 120, 212, 0.2);
      color: var(--text-color);
      border: 1px solid rgba(0, 120, 212, 0.3);
      border-bottom-right-radius: 0;
    }

    .message.ai {
      align-self: flex-start;
      background-color: var(--surface-hover-color);
      color: var(--text-color);
      border: 1px solid var(--border-color);
      border-bottom-left-radius: 0;
    }

    .ai-chat-input {
      padding: 1.25rem;
      border-top: 1px solid var(--border-color);
      display: flex;
      gap: 0.75rem;
      background-color: var(--surface-color);
    }

    .ai-chat-input input {
      flex: 1;
      padding: 0.875rem 1.25rem;
      background-color: var(--background-color);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      font-size: 1rem;
      color: var(--text-color);
      transition: var(--transition);
    }

    .ai-chat-input input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.2);
    }

    .ai-chat-input button {
      padding: 0.875rem 1.75rem;
      background-color: var(--primary-color);
      background-image: linear-gradient(to bottom, #0078d4, #005a9e);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow-sm);
    }

    .ai-chat-input button:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .ai-chat-input button:disabled {
      background-color: var(--border-color);
      background-image: none;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .navbar {
        padding: 0.75rem 1rem;
      }

      .navbar-nav {
        display: none;
      }

      .hero {
        padding: 4rem 1.5rem;
      }

      .hero h1 {
        font-size: 2.5rem;
      }

      .hero p {
        font-size: 1.1rem;
      }

      .hero-buttons {
        flex-direction: column;
        align-items: center;
        gap: 1rem;
      }

      .btn {
        width: 80%;
        max-width: 300px;
      }

      .features {
        padding: 3rem 1rem;
      }

      .features h2 {
        font-size: 2.2rem;
      }

      .features-grid {
        gap: 1.5rem;
      }

      .feature-card {
        padding: 2rem;
      }

      .ai-chat {
        padding: 3rem 1rem;
      }

      .ai-chat-messages {
        height: 350px;
        padding: 1.25rem;
      }

      .ai-chat-input {
        padding: 1rem;
        flex-direction: column;
      }

      .ai-chat-input input {
        width: 100%;
      }

      .ai-chat-input button {
        width: 100%;
        justify-content: center;
      }

      .features-page {
        padding: 3rem 1rem;
      }

      .features-page-header h1 {
        font-size: 2.2rem;
      }

      .features-list {
        gap: 1.5rem;
      }

      .feature-item {
        padding: 1.75rem;
      }
    }

    /* åŠ è½½åŠ¨ç”» */
    .loading {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-secondary-color);
    }

    .loading-dots {
      display: flex;
      gap: 0.25rem;
    }

    .loading-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: var(--primary-color);
      animation: loading 1.5s infinite ease-in-out;
    }

    .loading-dot:nth-child(2) {
      animation-delay: 0.2s;
    }

    .loading-dot:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes loading {
      0%, 80%, 100% {
        transform: scale(0);
      }
      40% {
        transform: scale(1);
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="module">
    // æ¶ˆæ¯ç±»å‹å®šä¹‰
    class Message {
      constructor(id, role, content) {
        this.id = id;
        this.role = role;
        this.content = content;
      }
    }

    // ä¸»åº”ç”¨ç»„ä»¶
    function App() {
      // é¡µé¢çŠ¶æ€
      const [currentPage, setCurrentPage] = React.useState('home');
      
      // AIå¯¹è¯çŠ¶æ€
      const [messages, setMessages] = React.useState([]);
      const [inputValue, setInputValue] = React.useState('');
      const [isLoading, setIsLoading] = React.useState(false);
      
      // AIç»˜ç”»çŠ¶æ€
      const [drawPrompt, setDrawPrompt] = React.useState('');
      const [drawImage, setDrawImage] = React.useState('');
      const [isDrawing, setIsDrawing] = React.useState(false);
      const [drawError, setDrawError] = React.useState('');
      
      // AIå‡ºé¢˜æµ‹è¯„çŠ¶æ€
      const [assessmentState, setAssessmentState] = React.useState({
        // é…ç½®ä¿¡æ¯
        selectedGrade: '',
        selectedSubject: '',
        selectedDifficulty: '',
        
        // é¢˜ç›®ä¿¡æ¯
        questions: [],
        currentQuestionIndex: 0,
        userAnswers: [],
        
        // çŠ¶æ€ä¿¡æ¯
        isLoading: false,
        error: '',
        showExplanation: false,
        explanation: '',
        
        // è¿½é—®åŠŸèƒ½
        showAskModal: false,
        askMessages: [],
        askInput: '',
        isAsking: false
      });
      
      // æ¶ˆæ¯å®¹å™¨å¼•ç”¨ï¼Œç”¨äºæ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
      const messagesEndRef = React.useRef(null);
      const askMessagesEndRef = React.useRef(null);

      // å½“æ¶ˆæ¯åˆ—è¡¨å˜åŒ–æ—¶ï¼Œæ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
      const scrollToBottom = () => {
        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
      };

      React.useEffect(() => {
        scrollToBottom();
      }, [messages, isLoading]);

      // æ™ºè°±AI APIé…ç½®
      const API_KEY = '4622524be02c461ca169160d9f01669d.YlDaSBLuxodfrtvQ';
      const API_URL = 'https://open.bigmodel.cn/api/paas/v4/chat/completions';
      
      // æ™ºè°±AIç»˜ç”»APIé…ç½®
      const DRAW_API_KEY = '4e3c3ce38ddd41d29c13e09870cd6da8.Z85j4GcZyTseJwRl';
      const DRAW_API_URL = 'https://open.bigmodel.cn/api/paas/v4/images/generations';
      
      // AIå‡ºé¢˜æµ‹è¯„APIé…ç½®
      const ASSESSMENT_API_KEY = '98fddaa6837f4f44b74b77833b41eeb5.v3VlXWgal9CMoGWz';
      const ASSESSMENT_API_URL = 'https://open.bigmodel.cn/api/paas/v4/chat/completions';
      
      // AIè§£æAPIé…ç½®
      const EXPLANATION_API_KEY = '51735ef366ad4902911491584419ced1.YpdtFYPuUlDO49AE';
      const EXPLANATION_API_URL = 'https://open.bigmodel.cn/api/paas/v4/chat/completions';
      
      // AIç­”ç–‘APIé…ç½®
      const TUTOR_API_KEY = '3104bb3761dc4d388a382384185487ce.19ZLebuxco6OVUGm';
      const TUTOR_API_URL = 'https://open.bigmodel.cn/api/paas/v4/chat/completions';

      // å‘é€æ¶ˆæ¯å¤„ç†å‡½æ•°
      const handleSendMessage = async () => {
        if (!inputValue.trim() || isLoading) return;

        // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
        const userMessage = new Message(
          Date.now().toString(),
          'user',
          inputValue.trim()
        );
        setMessages(prev => [...prev, userMessage]);
        setInputValue('');
        setIsLoading(true);

        try {
          // æ„å»ºAPIè¯·æ±‚å‚æ•°
          const requestData = {
            model: 'glm-4.7-flash',
            messages: [
              {
                role: 'user',
                content: userMessage.content
              }
            ],
            thinking: {
              type: 'enabled'
            },
            max_tokens: 65536,
            temperature: 1.0
          };

          // ç›´æ¥è°ƒç”¨æ™ºè°±AI API
          const response = await fetch(API_URL, {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${API_KEY}`,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestData)
          });

          // æ£€æŸ¥å“åº”çŠ¶æ€
          if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.error?.message || `APIè¯·æ±‚å¤±è´¥: ${response.status}`);
          }

          // è§£æå“åº”æ•°æ®
          const data = await response.json();
          
          // æå–AIçš„å›ç­”
          const aiContent = data.choices?.[0]?.message?.content || 'AIæš‚æ—¶æ— æ³•å›ç­”ï¼Œè¯·ç¨åé‡è¯•';
          
          // æ·»åŠ AIæ¶ˆæ¯
          const aiMessage = new Message(
            (Date.now() + 1).toString(),
            'ai',
            aiContent
          );
          setMessages(prev => [...prev, aiMessage]);
          setIsLoading(false);
        } catch (error) {
          console.error('å‘é€æ¶ˆæ¯å¤±è´¥:', error);
          
          // æ·»åŠ é”™è¯¯æ¶ˆæ¯
          const errorMessage = new Message(
            (Date.now() + 1).toString(),
            'ai',
            `æŠ±æ­‰ï¼ŒAIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ã€‚é”™è¯¯ä¿¡æ¯ï¼š${error.message || 'æœªçŸ¥é”™è¯¯'}`
          );
          setMessages(prev => [...prev, errorMessage]);
          setIsLoading(false);
        }
      };

      // å¤„ç†å›è½¦é”®å‘é€æ¶ˆæ¯
      const handleKeyPress = (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          handleSendMessage();
        }
      };

      // å¤„ç†å¯¼èˆªç‚¹å‡»
      const handleNavClick = (page) => {
        setCurrentPage(page);
        // é‡ç½®å¯¹åº”é¡µé¢çš„çŠ¶æ€
        if (page === 'chat') {
          resetChatState();
        } else if (page === 'draw') {
          resetDrawState();
        } else if (page === 'assessment') {
          resetAssessmentState();
        }
      };

      // é‡ç½®AIå¯¹è¯çŠ¶æ€
      const resetChatState = () => {
        setMessages([]);
        setInputValue('');
        setIsLoading(false);
      };

      // é‡ç½®AIç»˜ç”»çŠ¶æ€
      const resetDrawState = () => {
        setDrawPrompt('');
        setDrawImage('');
        setIsDrawing(false);
        setDrawError('');
      };
      
      // é‡ç½®AIå‡ºé¢˜æµ‹è¯„çŠ¶æ€
      const resetAssessmentState = () => {
        setAssessmentState({
          selectedGrade: '',
          selectedSubject: '',
          selectedDifficulty: '',
          questions: [],
          currentQuestionIndex: 0,
          userAnswers: [],
          isLoading: false,
          error: '',
          showExplanation: false,
          explanation: '',
          showAskModal: false,
          askMessages: [],
          askInput: '',
          isAsking: false
        });
      };

      // AIç»˜ç”»APIè°ƒç”¨å‡½æ•°
      const handleDrawImage = async () => {
        if (!drawPrompt.trim() || isDrawing) return;

        // é‡ç½®é”™è¯¯ä¿¡æ¯
        setDrawError('');
        setIsDrawing(true);
        setDrawImage('');

        try {
          // æ„å»ºAPIè¯·æ±‚å‚æ•°
          const requestData = {
            model: 'cogview-3-flash',
            prompt: drawPrompt.trim(),
            size: '1280x1280'
          };

          // è°ƒç”¨æ™ºè°±AIç»˜ç”»API
          const response = await fetch(DRAW_API_URL, {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${DRAW_API_KEY}`,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestData)
          });

          // æ£€æŸ¥å“åº”çŠ¶æ€
          if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.error?.message || `APIè¯·æ±‚å¤±è´¥: ${response.status}`);
          }

          // è§£æå“åº”æ•°æ®
          const data = await response.json();
          
          // æå–ç”Ÿæˆçš„å›¾åƒURL
          const imageUrl = data.data?.[0]?.url || '';
          
          if (!imageUrl) {
            throw new Error('ç”Ÿæˆå›¾åƒå¤±è´¥ï¼Œæœªè¿”å›å›¾åƒURL');
          }
          
          // è®¾ç½®ç”Ÿæˆçš„å›¾åƒ
          setDrawImage(imageUrl);
          setIsDrawing(false);
        } catch (error) {
          console.error('ç”Ÿæˆå›¾åƒå¤±è´¥:', error);
          setDrawError(error.message || 'ç”Ÿæˆå›¾åƒå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
          setIsDrawing(false);
        }
      };

      // AIå‡ºé¢˜æµ‹è¯„å‡½æ•°
      const handleGenerateQuestions = async () => {
        const { selectedGrade, selectedSubject, selectedDifficulty } = assessmentState;
        
        if (!selectedGrade || !selectedSubject || !selectedDifficulty) {
          setAssessmentState(prev => ({
            ...prev,
            error: 'è¯·é€‰æ‹©å­¦æ®µã€å­¦ç§‘å’Œéš¾åº¦'
          }));
          return;
        }

        setAssessmentState(prev => ({
          ...prev,
          isLoading: true,
          error: ''
        }));

        try {
          // æ„å»ºAPIè¯·æ±‚å‚æ•°
          const requestData = {
            model: 'glm-4.6v-flash',
            messages: [
              {
                role: 'user',
                content: `è¯·ä¸º${selectedGrade}çš„${selectedSubject}å­¦ç§‘ç”Ÿæˆ5é“${selectedDifficulty}éš¾åº¦çš„é¢˜ç›®ã€‚æ¯é“é¢˜ç›®éœ€è¦åŒ…å«é¢˜ç›®å†…å®¹ã€é€‰é¡¹ï¼ˆå¦‚æœæ˜¯é€‰æ‹©é¢˜ï¼‰ã€æ­£ç¡®ç­”æ¡ˆã€‚è¯·æŒ‰ç…§ä»¥ä¸‹æ ¼å¼è¿”å›ï¼š\n\né¢˜ç›®1ï¼š\nå†…å®¹ï¼š...\né€‰é¡¹ï¼šA. ... B. ... C. ... D. ...\nç­”æ¡ˆï¼š...\n\né¢˜ç›®2ï¼š\nå†…å®¹ï¼š...\né€‰é¡¹ï¼šA. ... B. ... C. ... D. ...\nç­”æ¡ˆï¼š...\n\nä»¥æ­¤ç±»æ¨ï¼Œå…±5é“é¢˜ç›®ã€‚`
              }
            ],
            thinking: {
              type: 'enabled'
            }
          };

          // è°ƒç”¨æ™ºè°±AIå‡ºé¢˜API
          const response = await fetch(ASSESSMENT_API_URL, {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${ASSESSMENT_API_KEY}`,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestData)
          });

          // æ£€æŸ¥å“åº”çŠ¶æ€
          if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.error?.message || `APIè¯·æ±‚å¤±è´¥: ${response.status}`);
          }

          // è§£æå“åº”æ•°æ®
          const data = await response.json();
          const content = data.choices?.[0]?.message?.content || '';

          // è§£æé¢˜ç›®
          const questions = parseQuestions(content);

          if (questions.length === 0) {
            throw new Error('ç”Ÿæˆé¢˜ç›®å¤±è´¥ï¼Œæœªè¿”å›æœ‰æ•ˆé¢˜ç›®');
          }

          // è®¾ç½®ç”Ÿæˆçš„é¢˜ç›®
          setAssessmentState(prev => ({
            ...prev,
            questions,
            currentQuestionIndex: 0,
            userAnswers: new Array(questions.length).fill(''),
            isLoading: false
          }));
        } catch (error) {
          console.error('ç”Ÿæˆé¢˜ç›®å¤±è´¥:', error);
          setAssessmentState(prev => ({
            ...prev,
            error: error.message || 'ç”Ÿæˆé¢˜ç›®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•',
            isLoading: false
          }));
        }
      };

      // è§£æé¢˜ç›®å‡½æ•°
      const parseQuestions = (content) => {
        const questions = [];
        const questionMatches = content.match(/é¢˜ç›®\d+ï¼š[\s\S]*?(?=é¢˜ç›®\d+ï¼š|$)/g);

        if (questionMatches) {
          questionMatches.forEach((match, index) => {
            // æå–é¢˜ç›®å†…å®¹
            const contentMatch = match.match(/å†…å®¹ï¼š([\s\S]*?)(?=é€‰é¡¹ï¼š|ç­”æ¡ˆï¼š|$)/);
            const questionContent = contentMatch ? contentMatch[1].trim() : '';

            // æå–é€‰é¡¹
            const optionsMatch = match.match(/é€‰é¡¹ï¼š([\s\S]*?)(?=ç­”æ¡ˆï¼š|$)/);
            let options = [];
            if (optionsMatch) {
              // æ”¹è¿›é€‰é¡¹è§£æé€»è¾‘
              const optionsText = optionsMatch[1].trim();
              // åŒ¹é…æ¯ä¸ªé€‰é¡¹ï¼Œæ ¼å¼å¦‚ï¼šA. é€‰é¡¹å†…å®¹
              const optionMatches = optionsText.match(/[A-D]\.\s*([^A-D]+)/g);
              if (optionMatches) {
                options = optionMatches.map(opt => opt.replace(/^[A-D]\.\s*/, '').trim());
              } else {
                // å¦‚æœè§£æå¤±è´¥ï¼Œå°è¯•ç®€å•åˆ†å‰²
                options = optionsText.split(/\s*[A-D]\.\s*/).filter(opt => opt);
              }
            }

            // æå–ç­”æ¡ˆ
            const answerMatch = match.match(/ç­”æ¡ˆï¼š(.*?)(?=\n|$)/);
            const correctAnswer = answerMatch ? answerMatch[1].trim() : '';

            if (questionContent && correctAnswer) {
              questions.push({
                id: index + 1,
                content: questionContent,
                options: options.length > 0 ? options : null,
                correctAnswer: correctAnswer
              });
            }
          });
        }

        return questions;
      };

      // å¤„ç†ç”¨æˆ·ç­”é¢˜å‡½æ•°
      const handleSubmitAnswer = (answer) => {
        const { questions, currentQuestionIndex, userAnswers } = assessmentState;
        const currentQuestion = questions[currentQuestionIndex];

        // æ£€æŸ¥ç­”æ¡ˆæ˜¯å¦æ­£ç¡®
        const isCorrect = answer.trim().toUpperCase() === currentQuestion.correctAnswer.trim().toUpperCase();

        // æ›´æ–°ç”¨æˆ·ç­”æ¡ˆ
        const updatedAnswers = [...userAnswers];
        updatedAnswers[currentQuestionIndex] = answer;

        // æ— è®ºç­”æ¡ˆæ˜¯å¦æ­£ç¡®ï¼Œéƒ½è·å–è§£æ
        getQuestionExplanation(currentQuestion, answer, updatedAnswers, isCorrect);
      };

      // è·å–é¢˜ç›®è§£æå‡½æ•°
      const getQuestionExplanation = async (question, userAnswer, updatedAnswers, isCorrect) => {
        setAssessmentState(prev => ({
          ...prev,
          isLoading: true,
          userAnswers: updatedAnswers,
          showExplanation: true, // ç«‹å³æ˜¾ç¤ºè§£ææ¡†ä½“
          explanation: 'ç”Ÿæˆè§£æä¸­...' // æ˜¾ç¤ºç”Ÿæˆä¸­çš„æç¤º
        }));

        try {
          // æ„å»ºAPIè¯·æ±‚å‚æ•°
          const requestData = {
            model: 'glm-4.7-flash',
            messages: [
              {
                role: 'user',
                content: `é¢˜ç›®ï¼š${question.content}\né€‰é¡¹ï¼š${question.options ? question.options.map((opt, i) => `${String.fromCharCode(65 + i)}. ${opt}`).join(' ') : 'æ— '}\næ­£ç¡®ç­”æ¡ˆï¼š${question.correctAnswer}\nç”¨æˆ·ç­”æ¡ˆï¼š${userAnswer}\nè¯·è¯¦ç»†è§£æè¿™é“é¢˜ï¼Œè¯´æ˜æ­£ç¡®ç­”æ¡ˆçš„åŸå› å’Œå…¶ä»–é€‰é¡¹çš„é”™è¯¯ä¹‹å¤„ã€‚`
              }
            ],
            thinking: {
              type: 'enabled'
            },
            max_tokens: 65536,
            temperature: 1.0
          };

          // è°ƒç”¨æ™ºè°±AIè§£æAPI
          const response = await fetch(EXPLANATION_API_URL, {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${EXPLANATION_API_KEY}`,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestData)
          });

          // æ£€æŸ¥å“åº”çŠ¶æ€
          if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.error?.message || `APIè¯·æ±‚å¤±è´¥: ${response.status}`);
          }

          // è§£æå“åº”æ•°æ®
          const data = await response.json();
          const explanation = data.choices?.[0]?.message?.content || '';

          // è®¾ç½®è§£æ
          setAssessmentState(prev => ({
            ...prev,
            isLoading: false,
            showExplanation: true,
            explanation,
            isCorrect: isCorrect // å­˜å‚¨ç­”æ¡ˆæ˜¯å¦æ­£ç¡®
          }));
        } catch (error) {
          console.error('è·å–è§£æå¤±è´¥:', error);
          setAssessmentState(prev => ({
            ...prev,
            isLoading: false,
            error: error.message || 'è·å–è§£æå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•',
            isCorrect: isCorrect // å­˜å‚¨ç­”æ¡ˆæ˜¯å¦æ­£ç¡®
          }));
        }
      };

      // è¿›å…¥ä¸‹ä¸€é¢˜å‡½æ•°
      const handleNextQuestion = () => {
        setAssessmentState(prev => {
          const nextIndex = prev.currentQuestionIndex + 1;
          return {
            ...prev,
            currentQuestionIndex: nextIndex,
            showExplanation: false,
            explanation: '',
            error: '',
            isCorrect: undefined // é‡ç½®ç­”æ¡ˆæ­£ç¡®çŠ¶æ€
          };
        });
      };

      // æ‰“å¼€è¿½é—®æ¨¡æ€æ¡†å‡½æ•°
      const openAskModal = () => {
        const { currentQuestionIndex, questions } = assessmentState;
        const currentQuestion = questions[currentQuestionIndex];
        
        // æ„å»ºåŒ…å«é¢˜ç›®ä¿¡æ¯çš„æç¤º
        const questionInfo = `é¢˜ç›®ï¼š${currentQuestion.content}\n${currentQuestion.options ? `é€‰é¡¹ï¼š${currentQuestion.options.map((opt, i) => `${String.fromCharCode(65 + i)}. ${opt}`).join(' ')}\n` : ''}æ­£ç¡®ç­”æ¡ˆï¼š${currentQuestion.correctAnswer}`;
        
        setAssessmentState(prev => ({
          ...prev,
          showAskModal: true,
          askMessages: [
            {
              role: 'ai',
              content: `ä½ å¥½ï¼æˆ‘æ˜¯è¾°å…‰æœªæ¥æ˜Ÿçš„AIè¾…å¯¼è€å¸ˆï¼Œæœ‰ä»€ä¹ˆé—®é¢˜å¯ä»¥é—®æˆ‘ï¼Ÿ\n\nå½“å‰é¢˜ç›®ä¿¡æ¯ï¼š\n${questionInfo}`
            }
          ]
        }));
      };

      // å…³é—­è¿½é—®æ¨¡æ€æ¡†å‡½æ•°
      const closeAskModal = () => {
        setAssessmentState(prev => ({
          ...prev,
          showAskModal: false,
          askMessages: [],
          askInput: '',
          isAsking: false
        }));
      };

      // å¤„ç†è¿½é—®å‘é€å‡½æ•°
      const handleAskQuestion = async () => {
        const { askInput, askMessages, currentQuestionIndex, questions } = assessmentState;
        const currentQuestion = questions[currentQuestionIndex];

        if (!askInput.trim()) return;

        // æ·»åŠ ç”¨æˆ·é—®é¢˜
        const updatedMessages = [...askMessages, {
          role: 'user',
          content: askInput
        }];

        setAssessmentState(prev => ({
          ...prev,
          askMessages: updatedMessages,
          askInput: '',
          isAsking: true
        }));

        try {
          // æ„å»ºAPIè¯·æ±‚å‚æ•°
          const requestData = {
            model: 'glm-4.1v-thinking-flash',
            messages: [
              {
                role: 'user',
                content: `ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„AIè¾…å¯¼è€å¸ˆï¼Œæ“…é•¿è§£ç­”å„ç§å­¦ç§‘é—®é¢˜ã€‚\n\n${askInput}`
              }
            ],
            stream: false,
            temperature: 1
          };

          // è°ƒç”¨æ™ºè°±AIç­”ç–‘API
          const response = await fetch(TUTOR_API_URL, {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${TUTOR_API_KEY}`,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestData)
          });

          // æ£€æŸ¥å“åº”çŠ¶æ€
          if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.error?.message || `APIè¯·æ±‚å¤±è´¥: ${response.status}`);
          }

          // è§£æå“åº”æ•°æ®
          const data = await response.json();
          const content = data.choices?.[0]?.message?.content || '';

          // æ·»åŠ AIå›ç­”
          const finalMessages = [...updatedMessages, {
            role: 'assistant',
            content
          }];

          setAssessmentState(prev => ({
            ...prev,
            askMessages: finalMessages,
            isAsking: false
          }));
        } catch (error) {
          console.error('å‘é€é—®é¢˜å¤±è´¥:', error);
          setAssessmentState(prev => ({
            ...prev,
            isAsking: false
          }));
        }
      };

      // å½“è¿½é—®æ¶ˆæ¯åˆ—è¡¨å˜åŒ–æ—¶ï¼Œæ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
      const scrollAskToBottom = () => {
        askMessagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
      };

      React.useEffect(() => {
        scrollAskToBottom();
      }, [assessmentState.askMessages, assessmentState.isAsking]);

      // é¦–é¡µ
      const renderHomePage = () => (
        React.createElement(React.Fragment, null, [
          // è‹±é›„åŒºåŸŸ
          React.createElement('section', { className: 'hero' }, [
            React.createElement('h1', null, 'æ™ºèƒ½å­¦ä¹ ï¼Œç‚¹äº®æœªæ¥'),
            React.createElement('p', null, 'è¾°å…‰æœªæ¥æ˜Ÿ - æ‚¨çš„ä¸ªæ€§åŒ–AIå­¦ä¹ åŠ©æ‰‹ï¼Œè®©å­¦ä¹ æ›´é«˜æ•ˆã€æ›´æœ‰è¶£'),
            React.createElement('div', { className: 'hero-buttons' }, [
              React.createElement('button', {
                className: 'btn btn-primary',
                onClick: () => handleNavClick('features')
              }, 'æ¢ç´¢åŠŸèƒ½'),
              React.createElement('button', {
                className: 'btn btn-secondary',
                onClick: () => handleNavClick('chat')
              }, 'ç«‹å³å¯¹è¯')
            ])
          ]),

          // åŠŸèƒ½åŒºåŸŸé¢„è§ˆ
          React.createElement('section', { className: 'features', id: 'features' }, [
            React.createElement('h2', null, 'æ ¸å¿ƒåŠŸèƒ½'),
            React.createElement('div', { className: 'features-grid' }, [
              React.createElement('div', { className: 'feature-card' }, [
                React.createElement('div', { className: 'feature-icon' }, 'ğŸ’¬'),
                React.createElement('h3', null, 'AIæ™ºèƒ½é—®ç­”'),
                React.createElement('p', null, 'åŸºäºæ™ºè°±AIçš„å¼ºå¤§å¯¹è¯èƒ½åŠ›ï¼Œä¸ºæ‚¨æä¾›ä¸“ä¸šã€å‡†ç¡®çš„å­¦ä¹ è§£ç­”'),
                React.createElement('button', {
                  className: 'feature-btn',
                  onClick: () => handleNavClick('features')
                }, 'äº†è§£æ›´å¤š')
              ]),
              React.createElement('div', { className: 'feature-card' }, [
                React.createElement('div', { className: 'feature-icon' }, 'ğŸ¨'),
                React.createElement('h3', null, 'AIç»˜ç”»'),
                React.createElement('p', null, 'ä½¿ç”¨å…ˆè¿›çš„AIç»˜ç”»æŠ€æœ¯ï¼Œå°†æ‚¨çš„åˆ›æ„å˜ä¸ºç°å®'),
                React.createElement('button', {
                  className: 'feature-btn',
                  onClick: () => handleNavClick('draw')
                }, 'äº†è§£æ›´å¤š')
              ]),
              React.createElement('div', { className: 'feature-card' }, [
                React.createElement('div', { className: 'feature-icon' }, 'ğŸ“'),
                React.createElement('h3', null, 'AIå‡ºé¢˜æµ‹è¯„'),
                React.createElement('p', null, 'æ ¹æ®æ‚¨çš„å­¦ä¹ è¿›åº¦ï¼Œæ™ºèƒ½ç”Ÿæˆä¸ªæ€§åŒ–æµ‹è¯„é¢˜ç›®'),
                React.createElement('button', {
                  className: 'feature-btn',
                  onClick: () => handleNavClick('assessment')
                }, 'äº†è§£æ›´å¤š')
              ]),
              React.createElement('div', { className: 'feature-card' }, [
                React.createElement('div', { className: 'feature-icon' }, 'âœ¨'),
                React.createElement('h3', null, 'AIæ‰¹æ”¹'),
                React.createElement('p', null, 'å¿«é€Ÿæ‰¹æ”¹ä½œä¸šå’Œè¯•å·ï¼Œæä¾›è¯¦ç»†çš„åˆ†æå’Œå»ºè®®'),
                React.createElement('button', {
                  className: 'feature-btn',
                  onClick: () => handleNavClick('features')
                }, 'äº†è§£æ›´å¤š')
              ])
            ])
          ])
        ])
      );

      // åŠŸèƒ½é¡µé¢
      const renderFeaturesPage = () => (
        React.createElement('div', { className: 'features-page' }, [
          React.createElement('div', { className: 'features-page-header' }, [
            React.createElement('h1', null, 'å¼ºå¤§åŠŸèƒ½ï¼Œæ™ºèƒ½å­¦ä¹ '),
            React.createElement('p', null, 'è¾°å…‰æœªæ¥æ˜Ÿæä¾›å¤šç§AIé©±åŠ¨çš„å­¦ä¹ å·¥å…·ï¼Œæ»¡è¶³æ‚¨çš„å„ç§å­¦ä¹ éœ€æ±‚ï¼Œè®©å­¦ä¹ å˜å¾—æ›´åŠ é«˜æ•ˆã€æœ‰è¶£ã€‚')
          ]),
          
          // AI å·¥å…·åˆ†ç±»
          React.createElement('div', { className: 'features-category' }, [
            React.createElement('h2', null, 'ğŸ¤– AI æ™ºèƒ½å·¥å…·'),
            React.createElement('div', { className: 'features-list' }, [
              // AIå¯¹è¯åŠŸèƒ½
              React.createElement('div', { className: 'feature-item' }, [
                React.createElement('div', { className: 'feature-item-icon' }, 'ğŸ’¬'),
                React.createElement('h3', null, 'AIæ™ºèƒ½å¯¹è¯'),
                React.createElement('p', null, 'ä¸AIè¿›è¡Œå®æ—¶å¯¹è¯ï¼Œè·å–ä¸“ä¸šçš„å­¦ä¹ è§£ç­”ï¼Œè§£å†³æ‚¨åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°çš„å„ç§é—®é¢˜ã€‚'),
                React.createElement('button', {
                  className: 'feature-item-btn',
                  onClick: () => {
                    handleNavClick('chat');
                    resetChatState();
                  }
                }, 'å¼€å§‹å¯¹è¯')
              ]),
              
              // AIç»˜ç”»åŠŸèƒ½
              React.createElement('div', { className: 'feature-item' }, [
                React.createElement('div', { className: 'feature-item-icon' }, 'ğŸ¨'),
                React.createElement('h3', null, 'AIç»˜ç”»'),
                React.createElement('p', null, 'ä½¿ç”¨å…ˆè¿›çš„AIç»˜ç”»æŠ€æœ¯ï¼Œå°†æ‚¨çš„åˆ›æ„å˜ä¸ºç°å®ï¼Œä¸ºå­¦ä¹ æ·»åŠ æ›´å¤šè§†è§‰å…ƒç´ ã€‚'),
                React.createElement('button', {
                  className: 'feature-item-btn',
                  onClick: () => handleNavClick('draw')
                }, 'ç«‹å³åˆ›ä½œ')
              ]),
              
              // AIå‡ºé¢˜æµ‹è¯„åŠŸèƒ½
              React.createElement('div', { className: 'feature-item' }, [
                React.createElement('div', { className: 'feature-item-icon' }, 'ğŸ“'),
                React.createElement('h3', null, 'AIå‡ºé¢˜æµ‹è¯„'),
                React.createElement('p', null, 'æ ¹æ®æ‚¨çš„å­¦ä¹ è¿›åº¦ï¼Œæ™ºèƒ½ç”Ÿæˆä¸ªæ€§åŒ–æµ‹è¯„é¢˜ç›®ï¼Œå¸®åŠ©æ‚¨æ£€éªŒå­¦ä¹ æˆæœã€‚'),
                React.createElement('button', {
                  className: 'feature-item-btn',
                  onClick: () => handleNavClick('assessment')
                }, 'å¼€å§‹æµ‹è¯„')
              ])
            ])
          ]),
          
          // å­¦ä¹ å·¥å…·åˆ†ç±»
          React.createElement('div', { className: 'features-category' }, [
            React.createElement('h2', null, 'ğŸ“š å­¦ä¹ è¾…åŠ©å·¥å…·'),
            React.createElement('div', { className: 'features-list' }, [
              // AIæ‰¹æ”¹åŠŸèƒ½
              React.createElement('div', { className: 'feature-item' }, [
                React.createElement('div', { className: 'feature-item-icon' }, 'âœ¨'),
                React.createElement('h3', null, 'AIæ‰¹æ”¹'),
                React.createElement('p', null, 'å¿«é€Ÿæ‰¹æ”¹ä½œä¸šå’Œè¯•å·ï¼Œæä¾›è¯¦ç»†çš„åˆ†æå’Œå»ºè®®ï¼Œå¸®åŠ©æ‚¨æé«˜å­¦ä¹ æ•ˆç‡ã€‚'),
                React.createElement('button', {
                  className: 'feature-item-btn'
                }, 'ç«‹å³æ‰¹æ”¹')
              ]),
              
              // çŸ¥è¯†å›¾è°±åŠŸèƒ½
              React.createElement('div', { className: 'feature-item' }, [
                React.createElement('div', { className: 'feature-item-icon' }, 'ğŸ”—'),
                React.createElement('h3', null, 'çŸ¥è¯†å›¾è°±'),
                React.createElement('p', null, 'å¯è§†åŒ–å±•ç¤ºçŸ¥è¯†ç‚¹ä¹‹é—´çš„å…³è”ï¼Œå¸®åŠ©æ‚¨æ„å»ºå®Œæ•´çš„çŸ¥è¯†ä½“ç³»ã€‚'),
                React.createElement('button', {
                  className: 'feature-item-btn'
                }, 'æ¢ç´¢å›¾è°±')
              ]),
              
              // å­¦ä¹ è®¡åˆ’åŠŸèƒ½
              React.createElement('div', { className: 'feature-item' }, [
                React.createElement('div', { className: 'feature-item-icon' }, 'ğŸ“…'),
                React.createElement('h3', null, 'å­¦ä¹ è®¡åˆ’'),
                React.createElement('p', null, 'æ™ºèƒ½åˆ¶å®šä¸ªæ€§åŒ–å­¦ä¹ è®¡åˆ’ï¼Œæ ¹æ®æ‚¨çš„å­¦ä¹ ç›®æ ‡å’Œæ—¶é—´å®‰æ’ï¼Œä¼˜åŒ–å­¦ä¹ è·¯å¾„ã€‚'),
                React.createElement('button', {
                  className: 'feature-item-btn'
                }, 'åˆ¶å®šè®¡åˆ’')
              ])
            ])
          ])
        ])
      );

      // AIå¯¹è¯é¡µé¢
      const renderChatPage = () => (
        React.createElement('section', { className: 'ai-chat', id: 'ai-chat' }, [
          React.createElement('div', { className: 'ai-chat-container' }, [
            React.createElement('div', { className: 'ai-chat-header' }, 'AIæ™ºèƒ½å¯¹è¯'),
            React.createElement('div', { className: 'ai-chat-messages' }, [
              messages.length === 0 ? (
                React.createElement('div', { className: 'message ai' }, 'ä½ å¥½ï¼æˆ‘æ˜¯è¾°å…‰æœªæ¥æ˜Ÿçš„AIåŠ©æ‰‹ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ')
              ) : (
                messages.map(message => (
                  React.createElement('div', { key: message.id, className: `message ${message.role}` }, message.content)
                ))
              ),
              isLoading && (
                React.createElement('div', { className: 'message ai' }, [
                  React.createElement('div', { className: 'loading' }, [
                    'AIæ­£åœ¨æ€è€ƒ',
                    React.createElement('div', { className: 'loading-dots' }, [
                      React.createElement('div', { className: 'loading-dot' }),
                      React.createElement('div', { className: 'loading-dot' }),
                      React.createElement('div', { className: 'loading-dot' })
                    ])
                  ])
                ])
              ),
              // ç”¨äºæ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯çš„å…ƒç´ 
              React.createElement('div', { ref: messagesEndRef })
            ]),
            React.createElement('div', { className: 'ai-chat-input' }, [
              React.createElement('input', {
                type: 'text',
                value: inputValue,
                onChange: (e) => setInputValue(e.target.value),
                onKeyPress: handleKeyPress,
                placeholder: 'è¾“å…¥ä½ çš„é—®é¢˜...',
                disabled: isLoading
              }),
              React.createElement('button', {
                onClick: handleSendMessage,
                disabled: isLoading
              }, 'å‘é€')
            ])
          ])
        ])
      );

      // AIç»˜ç”»é¡µé¢
      const renderDrawPage = () => (
        React.createElement('section', { className: 'ai-chat' }, [
          React.createElement('div', { className: 'ai-chat-container' }, [
            React.createElement('div', { className: 'ai-chat-header' }, 'AIç»˜ç”»'),
            
            // ç»˜ç”»æç¤ºè¯è¾“å…¥åŒºåŸŸ
            React.createElement('div', { className: 'ai-chat-input' }, [
              React.createElement('input', {
                type: 'text',
                value: drawPrompt,
                onChange: (e) => setDrawPrompt(e.target.value),
                placeholder: 'è¾“å…¥ä½ çš„ç»˜ç”»æè¿°ï¼Œä¾‹å¦‚ï¼šä¸€åªå¯çˆ±çš„å°çŒ«å’ªï¼Œååœ¨é˜³å…‰æ˜åªšçš„çª—å°ä¸Šï¼ŒèƒŒæ™¯æ˜¯è“å¤©ç™½äº‘',
                disabled: isDrawing
              }),
              React.createElement('button', {
                onClick: handleDrawImage,
                disabled: isDrawing || !drawPrompt.trim()
              }, isDrawing ? 'ç”Ÿæˆä¸­...' : 'ç”Ÿæˆ')
            ]),
            
            // ç»˜ç”»ç»“æœæ˜¾ç¤ºåŒºåŸŸ
            React.createElement('div', { style: { padding: '1.75rem' } }, [
              // é”™è¯¯æç¤º
              drawError && React.createElement('div', {
                style: {
                  color: '#f44336',
                  backgroundColor: 'rgba(244, 67, 54, 0.1)',
                  border: '1px solid #f44336',
                  borderRadius: 'var(--border-radius)',
                  padding: '1rem',
                  marginBottom: '1rem'
                }
              }, drawError),
              
              // åŠ è½½çŠ¶æ€
              isDrawing && React.createElement('div', {
                style: {
                  display: 'flex',
                  flexDirection: 'column',
                  alignItems: 'center',
                  justifyContent: 'center',
                  padding: '3rem',
                  backgroundColor: 'rgba(0, 0, 0, 0.1)',
                  borderRadius: 'var(--border-radius)'
                }
              }, [
                React.createElement('div', { className: 'loading' }, [
                  'AIæ­£åœ¨ç»˜ç”»',
                  React.createElement('div', { className: 'loading-dots' }, [
                    React.createElement('div', { className: 'loading-dot' }),
                    React.createElement('div', { className: 'loading-dot' }),
                    React.createElement('div', { className: 'loading-dot' })
                  ])
                ]),
                React.createElement('p', {
                  style: {
                    color: 'var(--text-secondary-color)',
                    marginTop: '1rem',
                    textAlign: 'center'
                  }
                }, 'è¯·è€å¿ƒç­‰å¾…ï¼ŒAIæ­£åœ¨åˆ›ä½œä½ çš„ä½œå“...')
              ]),
              
              // ç”Ÿæˆçš„å›¾åƒ
              drawImage && React.createElement('div', {
                style: {
                  textAlign: 'center',
                  backgroundColor: 'rgba(0, 0, 0, 0.1)',
                  borderRadius: 'var(--border-radius)',
                  padding: '1.5rem'
                }
              }, [
                React.createElement('h3', {
                  style: {
                    color: 'var(--text-color)',
                    marginBottom: '1rem'
                  }
                }, 'ç”Ÿæˆç»“æœ'),
                React.createElement('img', {
                  src: drawImage,
                  alt: 'AIç”Ÿæˆçš„å›¾åƒ',
                  style: {
                    maxWidth: '100%',
                    maxHeight: '600px',
                    borderRadius: 'var(--border-radius)',
                    boxShadow: 'var(--shadow-lg)'
                  }
                }),
                React.createElement('div', {
                  style: {
                    marginTop: '1.5rem'
                  }
                }, [
                  React.createElement('button', {
                    style: {
                      backgroundColor: 'var(--primary-color)',
                      color: 'white',
                      border: 'none',
                      borderRadius: 'var(--border-radius)',
                      padding: '0.6rem 1.2rem',
                      marginRight: '0.5rem',
                      cursor: 'pointer'
                    },
                    onClick: () => setDrawPrompt('')
                  }, 'é‡æ–°ç”Ÿæˆ'),
                  React.createElement('a', {
                    href: drawImage,
                    target: '_blank',
                    rel: 'noopener noreferrer',
                    style: {
                      backgroundColor: 'var(--surface-color)',
                      color: 'var(--text-color)',
                      border: '1px solid var(--border-color)',
                      borderRadius: 'var(--border-radius)',
                      padding: '0.6rem 1.2rem',
                      textDecoration: 'none',
                      display: 'inline-block'
                    }
                  }, 'ä¸‹è½½å›¾åƒ')
                ])
              ]),
              
              // æç¤ºä¿¡æ¯
              !drawImage && !isDrawing && !drawError && React.createElement('div', {
                style: {
                  color: 'var(--text-secondary-color)',
                  backgroundColor: 'rgba(0, 0, 0, 0.1)',
                  borderRadius: 'var(--border-radius)',
                  padding: '2rem',
                  textAlign: 'center'
                }
              }, [
                React.createElement('div', {
                  style: {
                    fontSize: '3rem',
                    marginBottom: '1rem'
                  }
                }, 'ğŸ¨'),
                React.createElement('h3', {
                  style: {
                    color: 'var(--text-color)',
                    marginBottom: '1rem'
                  }
                }, 'AIç»˜ç”»åŠŸèƒ½'),
                React.createElement('p', null, 'è¾“å…¥è¯¦ç»†çš„æè¿°ï¼ŒAIå°†ä¸ºä½ ç”Ÿæˆç²¾ç¾çš„å›¾åƒã€‚\næè¿°è¶Šè¯¦ç»†ï¼Œç”Ÿæˆçš„å›¾åƒè¶Šç¬¦åˆä½ çš„é¢„æœŸã€‚')
              ])
            ])
          ])
        ])
      );

      // AIå‡ºé¢˜æµ‹è¯„é¡µé¢
      const renderAssessmentPage = () => {
        const { 
          selectedGrade, 
          selectedSubject, 
          selectedDifficulty, 
          questions, 
          currentQuestionIndex, 
          userAnswers, 
          isLoading, 
          error, 
          showExplanation, 
          explanation, 
          showAskModal, 
          askMessages, 
          askInput, 
          isAsking 
        } = assessmentState;

        const currentQuestion = questions[currentQuestionIndex];
        const hasQuestions = questions.length > 0;
        const isLastQuestion = currentQuestionIndex === questions.length - 1;

        // å­¦æ®µé€‰é¡¹
        const grades = ['å°å­¦', 'åˆä¸­', 'é«˜ä¸­'];
        // å­¦ç§‘é€‰é¡¹
        const subjects = ['æ•°å­¦', 'è¯­æ–‡', 'è‹±è¯­', 'ç‰©ç†', 'åŒ–å­¦', 'ç”Ÿç‰©', 'å†å²', 'åœ°ç†', 'æ”¿æ²»'];
        // éš¾åº¦é€‰é¡¹
        const difficulties = ['ç®€å•', 'ä¸­ç­‰', 'å›°éš¾'];

        return React.createElement('section', { className: 'ai-chat' }, [
          React.createElement('div', { className: 'ai-chat-container' }, [
            React.createElement('div', { className: 'ai-chat-header' }, 'AIå‡ºé¢˜æµ‹è¯„'),
            
            // é…ç½®åŒºåŸŸ
            !hasQuestions ? (
              React.createElement('div', { style: { padding: '1.75rem' } }, [
                // é”™è¯¯æç¤º
                error && React.createElement('div', {
                  style: {
                    color: '#f44336',
                    backgroundColor: 'rgba(244, 67, 54, 0.1)',
                    border: '1px solid #f44336',
                    borderRadius: 'var(--border-radius)',
                    padding: '1rem',
                    marginBottom: '1.5rem'
                  }
                }, error),
                
                // é€‰æ‹©è¡¨å•
                React.createElement('div', {
                  style: {
                    backgroundColor: 'rgba(0, 0, 0, 0.1)',
                    borderRadius: 'var(--border-radius)',
                    padding: '2rem'
                  }
                }, [
                  React.createElement('h3', {
                    style: {
                      color: 'var(--text-color)',
                      marginBottom: '1.5rem',
                      textAlign: 'center'
                    }
                  }, 'é€‰æ‹©æµ‹è¯„é…ç½®'),
                  
                  // å­¦æ®µé€‰æ‹©
                  React.createElement('div', {
                    style: {
                      marginBottom: '1.5rem'
                    }
                  }, [
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        color: 'var(--text-color)',
                        marginBottom: '0.5rem',
                        fontWeight: '500'
                      }
                    }, 'å­¦æ®µ'),
                    React.createElement('select', {
                      value: selectedGrade,
                      onChange: (e) => setAssessmentState(prev => ({ ...prev, selectedGrade: e.target.value })),
                      style: {
                        width: '100%',
                        padding: '0.875rem',
                        backgroundColor: 'var(--background-color)',
                        border: '1px solid var(--border-color)',
                        borderRadius: 'var(--border-radius)',
                        color: 'var(--text-color)',
                        fontSize: '1rem'
                      }
                    }, [
                      React.createElement('option', { value: '' }, 'è¯·é€‰æ‹©å­¦æ®µ'),
                      ...grades.map(grade => React.createElement('option', { key: grade, value: grade }, grade))
                    ])
                  ]),
                  
                  // å­¦ç§‘é€‰æ‹©
                  React.createElement('div', {
                    style: {
                      marginBottom: '1.5rem'
                    }
                  }, [
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        color: 'var(--text-color)',
                        marginBottom: '0.5rem',
                        fontWeight: '500'
                      }
                    }, 'å­¦ç§‘'),
                    React.createElement('select', {
                      value: selectedSubject,
                      onChange: (e) => setAssessmentState(prev => ({ ...prev, selectedSubject: e.target.value })),
                      style: {
                        width: '100%',
                        padding: '0.875rem',
                        backgroundColor: 'var(--background-color)',
                        border: '1px solid var(--border-color)',
                        borderRadius: 'var(--border-radius)',
                        color: 'var(--text-color)',
                        fontSize: '1rem'
                      }
                    }, [
                      React.createElement('option', { value: '' }, 'è¯·é€‰æ‹©å­¦ç§‘'),
                      ...subjects.map(subject => React.createElement('option', { key: subject, value: subject }, subject))
                    ])
                  ]),
                  
                  // éš¾åº¦é€‰æ‹©
                  React.createElement('div', {
                    style: {
                      marginBottom: '2rem'
                    }
                  }, [
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        color: 'var(--text-color)',
                        marginBottom: '0.5rem',
                        fontWeight: '500'
                      }
                    }, 'éš¾åº¦'),
                    React.createElement('select', {
                      value: selectedDifficulty,
                      onChange: (e) => setAssessmentState(prev => ({ ...prev, selectedDifficulty: e.target.value })),
                      style: {
                        width: '100%',
                        padding: '0.875rem',
                        backgroundColor: 'var(--background-color)',
                        border: '1px solid var(--border-color)',
                        borderRadius: 'var(--border-radius)',
                        color: 'var(--text-color)',
                        fontSize: '1rem'
                      }
                    }, [
                      React.createElement('option', { value: '' }, 'è¯·é€‰æ‹©éš¾åº¦'),
                      ...difficulties.map(difficulty => React.createElement('option', { key: difficulty, value: difficulty }, difficulty))
                    ])
                  ]),
                  
                  // ç”Ÿæˆé¢˜ç›®æŒ‰é’®
                  React.createElement('button', {
                    onClick: handleGenerateQuestions,
                    disabled: isLoading,
                    style: {
                      width: '100%',
                      padding: '0.875rem',
                      backgroundColor: 'var(--primary-color)',
                      color: 'white',
                      border: 'none',
                      borderRadius: 'var(--border-radius)',
                      fontSize: '1rem',
                      fontWeight: '500',
                      cursor: isLoading ? 'not-allowed' : 'pointer',
                      opacity: isLoading ? 0.7 : 1
                    }
                  }, isLoading ? 'ç”Ÿæˆé¢˜ç›®ä¸­...' : 'ç”Ÿæˆé¢˜ç›®')
                ])
              ])
            ) : (
              // é¢˜ç›®å±•ç¤ºåŒºåŸŸ
              React.createElement('div', { style: { padding: '1.75rem' } }, [
                // é¢˜ç›®å¯¼èˆª
                React.createElement('div', {
                  style: {
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'center',
                    marginBottom: '1.5rem'
                  }
                }, [
                  React.createElement('h3', {
                    style: {
                      color: 'var(--text-color)',
                      margin: 0
                    }
                  }, `é¢˜ç›® ${currentQuestionIndex + 1}/${questions.length}`),
                  React.createElement('div', {
                    style: {
                      display: 'flex',
                      gap: '0.5rem'
                    }
                  }, [
                    ...questions.map((q, index) => (
                      React.createElement('button', {
                        key: q.id,
                        onClick: () => setAssessmentState(prev => ({ ...prev, currentQuestionIndex: index })),
                        style: {
                          width: '32px',
                          height: '32px',
                          borderRadius: '50%',
                          border: '1px solid var(--border-color)',
                          backgroundColor: index === currentQuestionIndex ? 'var(--primary-color)' : 'var(--surface-color)',
                          color: index === currentQuestionIndex ? 'white' : 'var(--text-color)',
                          cursor: 'pointer',
                          fontSize: '0.9rem'
                        }
                      }, q.id)
                    ))
                  ])
                ]),
                
                // é¢˜ç›®å†…å®¹
                currentQuestion && React.createElement('div', {
                  style: {
                    backgroundColor: 'rgba(0, 0, 0, 0.1)',
                    borderRadius: 'var(--border-radius)',
                    padding: '2rem',
                    marginBottom: '1.5rem'
                  }
                }, [
                  React.createElement('div', {
                    style: {
                      color: 'var(--text-color)',
                      marginBottom: '1.5rem',
                      lineHeight: '1.6'
                    }
                  }, currentQuestion.content),
                  
                  // é€‰é¡¹ï¼ˆå¦‚æœæœ‰ï¼‰
                  currentQuestion.options && React.createElement('div', {
                    style: {
                      marginBottom: '1.5rem'
                    }
                  }, currentQuestion.options.map((option, index) => (
                    React.createElement('div', {
                      key: index,
                      style: {
                        marginBottom: '0.75rem'
                      }
                    }, [
                      React.createElement('label', {
                        style: {
                          display: 'flex',
                          alignItems: 'center',
                          gap: '0.75rem',
                          color: 'var(--text-secondary-color)',
                          cursor: 'pointer',
                          padding: '0.5rem',
                          borderRadius: 'var(--border-radius)',
                          transition: 'background-color 0.2s ease-in-out'
                        },
                        onClick: () => {
                          const selectedOption = String.fromCharCode(65 + index);
                          setAssessmentState(prev => {
                            const updatedAnswers = [...prev.userAnswers];
                            updatedAnswers[currentQuestionIndex] = selectedOption;
                            return { ...prev, userAnswers: updatedAnswers };
                          });
                        }
                      }, [
                        React.createElement('input', {
                          type: 'radio',
                          name: 'answer',
                          value: String.fromCharCode(65 + index),
                          checked: userAnswers[currentQuestionIndex] === String.fromCharCode(65 + index),
                          readOnly: true,
                          style: {
                            accentColor: 'var(--primary-color)',
                            cursor: 'pointer'
                          }
                        }),
                        React.createElement('span', null, `${String.fromCharCode(65 + index)}. ${option}`)
                      ])
                    ])
                  ))),
                  
                  // å¡«ç©ºé¢˜ç­”æ¡ˆè¾“å…¥
                  !currentQuestion.options && React.createElement('div', {
                    style: {
                      marginBottom: '1.5rem'
                    }
                  }, [
                    React.createElement('label', {
                      style: {
                        display: 'block',
                        color: 'var(--text-color)',
                        marginBottom: '0.5rem',
                        fontWeight: '500'
                      }
                    }, 'ç­”æ¡ˆ'),
                    React.createElement('input', {
                      type: 'text',
                      value: userAnswers[currentQuestionIndex] || '',
                      onChange: (e) => setAssessmentState(prev => {
                        const updatedAnswers = [...prev.userAnswers];
                        updatedAnswers[currentQuestionIndex] = e.target.value;
                        return { ...prev, userAnswers: updatedAnswers };
                      }),
                      style: {
                        width: '100%',
                        padding: '0.875rem',
                        backgroundColor: 'var(--background-color)',
                        border: '1px solid var(--border-color)',
                        borderRadius: 'var(--border-radius)',
                        color: 'var(--text-color)',
                        fontSize: '1rem'
                      }
                    })
                  ]),
                  
                  // æäº¤ç­”æ¡ˆæŒ‰é’®
                  !userAnswers[currentQuestionIndex] && React.createElement('button', {
                    onClick: () => handleSubmitAnswer(userAnswers[currentQuestionIndex] || ''),
                    disabled: !userAnswers[currentQuestionIndex],
                    style: {
                      padding: '0.875rem 1.75rem',
                      backgroundColor: 'var(--primary-color)',
                      color: 'white',
                      border: 'none',
                      borderRadius: 'var(--border-radius)',
                      fontSize: '1rem',
                      fontWeight: '500',
                      cursor: !userAnswers[currentQuestionIndex] ? 'not-allowed' : 'pointer',
                      opacity: !userAnswers[currentQuestionIndex] ? 0.7 : 1
                    }
                  }, 'æäº¤ç­”æ¡ˆ')
                ]),
                
                // è§£æåŒºåŸŸ
                showExplanation && React.createElement('div', {
                  style: {
                    backgroundColor: isCorrect ? 'rgba(0, 255, 0, 0.1)' : 'rgba(255, 165, 0, 0.1)',
                    border: `1px solid ${isCorrect ? '#4CAF50' : '#ffa500'}`,
                    borderRadius: 'var(--border-radius)',
                    padding: '1.5rem',
                    marginBottom: '1.5rem'
                  }
                }, [
                  React.createElement('h4', {
                    style: {
                      color: isCorrect ? '#4CAF50' : '#ffa500',
                      marginBottom: '1rem'
                    }
                  }, isCorrect ? 'å›ç­”æ­£ç¡®ï¼' : 'å›ç­”é”™è¯¯ï¼'),
                  React.createElement('h5', {
                    style: {
                      color: 'var(--text-color)',
                      marginBottom: '1rem'
                    }
                  }, 'é¢˜ç›®è§£æ'),
                  React.createElement('div', {
                    style: {
                      color: 'var(--text-secondary-color)',
                      lineHeight: '1.6'
                    }
                  }, explanation)
                ]),
                
                // æ­£ç¡®ç­”æ¡ˆæç¤º
                showExplanation && !isCorrect && React.createElement('div', {
                  style: {
                    backgroundColor: 'rgba(255, 165, 0, 0.1)',
                    border: '1px solid #ffa500',
                    borderRadius: 'var(--border-radius)',
                    padding: '1rem',
                    marginBottom: '1.5rem'
                  }
                }, [
                  React.createElement('p', {
                    style: {
                      color: '#ffa500',
                      margin: 0
                    }
                  }, `æ­£ç¡®ç­”æ¡ˆï¼š${currentQuestion.correctAnswer}`)
                ]),
                
                // æäº¤ç­”æ¡ˆæŒ‰é’®
                  !userAnswers[currentQuestionIndex] && React.createElement('button', {
                    onClick: () => handleSubmitAnswer(userAnswers[currentQuestionIndex] || ''),
                    disabled: !userAnswers[currentQuestionIndex],
                    style: {
                      padding: '0.875rem 1.75rem',
                      backgroundColor: 'var(--primary-color)',
                      color: 'white',
                      border: 'none',
                      borderRadius: 'var(--border-radius)',
                      fontSize: '1rem',
                      fontWeight: '500',
                      cursor: !userAnswers[currentQuestionIndex] ? 'not-allowed' : 'pointer',
                      opacity: !userAnswers[currentQuestionIndex] ? 0.7 : 1
                    }
                  }, 'æäº¤ç­”æ¡ˆ'),
                
                  // æ“ä½œæŒ‰é’®
                userAnswers[currentQuestionIndex] && React.createElement('div', {
                  style: {
                    display: 'flex',
                    justifyContent: 'space-between',
                    gap: '1rem'
                  }
                }, [
                  React.createElement('button', {
                    onClick: openAskModal,
                    style: {
                      padding: '0.75rem 1.5rem',
                      backgroundColor: 'var(--surface-color)',
                      color: 'var(--text-color)',
                      border: '1px solid var(--border-color)',
                      borderRadius: 'var(--border-radius)',
                      fontSize: '0.95rem',
                      fontWeight: '500',
                      cursor: 'pointer'
                    }
                  }, 'è¿½é—®'),
                  React.createElement('button', {
                    onClick: handleNextQuestion,
                    disabled: isLastQuestion,
                    style: {
                      padding: '0.75rem 1.5rem',
                      backgroundColor: isLastQuestion ? 'var(--border-color)' : 'var(--primary-color)',
                      color: 'white',
                      border: 'none',
                      borderRadius: 'var(--border-radius)',
                      fontSize: '0.95rem',
                      fontWeight: '500',
                      cursor: isLastQuestion ? 'not-allowed' : 'pointer',
                      opacity: isLastQuestion ? 0.7 : 1,
                      flex: 1
                    }
                  }, isLastQuestion ? 'æµ‹è¯„å®Œæˆ' : 'ä¸‹ä¸€é¢˜')
                ])
              ])
            )
          ]),
          
          // è¿½é—®æ¨¡æ€æ¡†
          showAskModal && React.createElement('div', {
            style: {
              position: 'fixed',
              top: 0,
              left: 0,
              right: 0,
              bottom: 0,
              backgroundColor: 'rgba(0, 0, 0, 0.7)',
              display: 'flex',
              justifyContent: 'center',
              alignItems: 'center',
              zIndex: 1000
            }
          }, [
            React.createElement('div', {
              style: {
                backgroundColor: 'var(--surface-color)',
                borderRadius: 'var(--border-radius)',
                width: '90%',
                maxWidth: '800px',
                maxHeight: '80vh',
                display: 'flex',
                flexDirection: 'column',
                boxShadow: 'var(--shadow-lg)'
              }
            }, [
              // æ¨¡æ€æ¡†å¤´éƒ¨
              React.createElement('div', {
                style: {
                  display: 'flex',
                  justifyContent: 'space-between',
                  alignItems: 'center',
                  padding: '1.5rem',
                  borderBottom: '1px solid var(--border-color)',
                  backgroundColor: 'var(--primary-color)',
                  color: 'white',
                  borderTopLeftRadius: 'var(--border-radius)',
                  borderTopRightRadius: 'var(--border-radius)'
                }
              }, [
                React.createElement('h3', {
                  style: {
                    margin: 0,
                    fontSize: '1.25rem'
                  }
                }, 'AIè¾…å¯¼è€å¸ˆ'),
                React.createElement('button', {
                  onClick: closeAskModal,
                  style: {
                    background: 'none',
                    border: 'none',
                    color: 'white',
                    fontSize: '1.5rem',
                    cursor: 'pointer',
                    padding: 0,
                    width: '30px',
                    height: '30px',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center'
                  }
                }, 'Ã—')
              ]),
              
              // æ¨¡æ€æ¡†å†…å®¹
              React.createElement('div', {
                style: {
                  padding: '1.5rem',
                  flex: 1,
                  overflowY: 'auto',
                  display: 'flex',
                  flexDirection: 'column',
                  gap: '1rem'
                }
              }, [
                ...askMessages.map((msg, index) => (
                  React.createElement('div', {
                    key: index,
                    style: {
                      alignSelf: msg.role === 'user' || msg.role === 'assistant' ? 'flex-end' : 'flex-start',
                      maxWidth: '80%',
                      padding: '1rem',
                      borderRadius: 'var(--border-radius)',
                      backgroundColor: msg.role === 'user' ? 'var(--primary-color)' : 'var(--surface-hover-color)',
                      color: msg.role === 'user' ? 'white' : 'var(--text-color)'
                    }
                  }, msg.content)
                )),
                // åŠ è½½åŠ¨ç”»
                isAsking && React.createElement('div', {
                  style: {
                    alignSelf: 'flex-start',
                    maxWidth: '80%',
                    padding: '1rem',
                    borderRadius: 'var(--border-radius)',
                    backgroundColor: 'var(--surface-hover-color)',
                    color: 'var(--text-color)'
                  }
                }, [
                  React.createElement('div', { className: 'loading' }, [
                    'AIæ­£åœ¨æ€è€ƒ',
                    React.createElement('div', { className: 'loading-dots' }, [
                      React.createElement('div', { className: 'loading-dot' }),
                      React.createElement('div', { className: 'loading-dot' }),
                      React.createElement('div', { className: 'loading-dot' })
                    ])
                  ])
                ]),
                React.createElement('div', { ref: askMessagesEndRef })
              ]),
              
              // æ¨¡æ€æ¡†è¾“å…¥
              React.createElement('div', {
                style: {
                  padding: '1.5rem',
                  borderTop: '1px solid var(--border-color)',
                  display: 'flex',
                  gap: '0.75rem'
                }
              }, [
                React.createElement('input', {
                  type: 'text',
                  value: askInput,
                  onChange: (e) => setAssessmentState(prev => ({ ...prev, askInput: e.target.value })),
                  onKeyPress: (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                      e.preventDefault();
                      handleAskQuestion();
                    }
                  },
                  placeholder: 'è¾“å…¥ä½ çš„é—®é¢˜...',
                  disabled: isAsking,
                  style: {
                    flex: 1,
                    padding: '0.75rem',
                    backgroundColor: 'var(--background-color)',
                    border: '1px solid var(--border-color)',
                    borderRadius: 'var(--border-radius)',
                    color: 'var(--text-color)',
                    fontSize: '1rem'
                  }
                }),
                React.createElement('button', {
                  onClick: handleAskQuestion,
                  disabled: isAsking || !askInput.trim(),
                  style: {
                    padding: '0.75rem 1.5rem',
                    backgroundColor: 'var(--primary-color)',
                    color: 'white',
                    border: 'none',
                    borderRadius: 'var(--border-radius)',
                    fontSize: '1rem',
                    fontWeight: '500',
                    cursor: isAsking ? 'not-allowed' : 'pointer',
                    opacity: isAsking || !askInput.trim() ? 0.7 : 1
                  }
                }, isAsking ? 'å‘é€ä¸­...' : 'å‘é€')
              ])
            ])
          ])
        ]);
      };

      return React.createElement('div', { className: 'app' }, [
        // å¯¼èˆªæ 
        React.createElement('nav', { className: 'navbar' }, [
          React.createElement('button', {
            className: 'navbar-logo',
            onClick: () => handleNavClick('home')
          }, [
            React.createElement('img', { src: 'logo.png', alt: 'è¾°å…‰æœªæ¥æ˜Ÿ', className: 'logo-image' })
          ]),
          React.createElement('ul', { className: 'navbar-nav' }, [
            React.createElement('li', null, React.createElement('button', {
              className: currentPage === 'home' ? 'nav-active' : '',
              onClick: () => handleNavClick('home')
            }, 'é¦–é¡µ')),
            React.createElement('li', null, React.createElement('button', {
              className: currentPage === 'features' ? 'nav-active' : '',
              onClick: () => handleNavClick('features')
            }, 'åŠŸèƒ½')),
            React.createElement('li', null, React.createElement('button', {
              className: currentPage === 'about' ? 'nav-active' : '',
              onClick: () => handleNavClick('about')
            }, 'å…³äº'))
          ]),
          React.createElement('button', {
            className: 'navbar-btn',
            onClick: () => handleNavClick('features')
          }, 'å¼€å§‹ä½¿ç”¨')
        ]),

        // é¡µé¢å†…å®¹
        currentPage === 'home' && renderHomePage(),
        currentPage === 'features' && renderFeaturesPage(),
        currentPage === 'chat' && renderChatPage(),
        currentPage === 'draw' && renderDrawPage(),
        currentPage === 'assessment' && renderAssessmentPage(),
        currentPage === 'about' && React.createElement('section', { className: 'features' }, [
          React.createElement('h2', null, 'å…³äºæˆ‘ä»¬'),
          React.createElement('p', null, 'è¾°å…‰æœªæ¥æ˜Ÿæ˜¯ä¸€ä¸ªä¸“æ³¨äºæ™ºèƒ½å­¦ä¹ çš„å¹³å°ï¼Œè‡´åŠ›äºé€šè¿‡AIæŠ€æœ¯ä¸ºç”¨æˆ·æä¾›ä¸ªæ€§åŒ–çš„å­¦ä¹ ä½“éªŒã€‚')
        ])
      ]);
    }

    // æ¸²æŸ“åº”ç”¨
    ReactDOM.createRoot(document.getElementById('root')).render(
      React.createElement(React.StrictMode, null, React.createElement(App))
    );
  </script>
  <!-- å¼•å…¥Reactå’ŒReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
</body>
</html>